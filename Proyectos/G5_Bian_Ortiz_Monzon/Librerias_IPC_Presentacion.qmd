---
title: "Librer√≠as utilizadas en el proyecto IPC Guatemala"
author: "Brian Bian, Fernando Ortiz, Jos√© Monz√≥n"
subtitle: "Programaci√≥n II"
format: 
  revealjs:
    theme: simple
    transition: fade
    slide-number: true
    logo: "LogoBanguat_2025.JPG"
    css: styles.css
    smaller: true
execute:
  echo: false
  warning: false
  message: false
---

## üß© Introducci√≥n {.center}

El an√°lisis del **√çndice de Precios al Consumidor (IPC)** utiliza diversas librer√≠as del ecosistema **tidyverse** y herramientas complementarias de R.  
Estas permiten **leer, transformar, limpiar, visualizar y automatizar** el procesamiento de datos del IPC de Guatemala.

---

## ‚öôÔ∏è Automatizaci√≥n del an√°lisis del IPC {.center}

El procesamiento tradicional del **√çndice de Precios al Consumidor (IPC)** suele realizarse en hojas de c√°lculo (por ejemplo, *Excel*),  
lo que implica:

- ‚è±Ô∏è **Mayor tiempo** en tareas repetitivas (copiar f√≥rmulas, crear tablas y gr√°ficos).  
- ‚ö†Ô∏è **Riesgo de errores humanos** al modificar celdas o referencias.  
- üìâ **Dificultad para actualizar datos** mes a mes.

---

### üí° Ventajas de automatizar con RStudio

Usar **RStudio** y el ecosistema **tidyverse** permite transformar este proceso en un flujo reproducible y confiable:

| Beneficio | Descripci√≥n |
|------------|--------------|
| ‚ö° **Eficiencia** | Los c√°lculos (variaciones, incidencias, gr√°ficas) se generan autom√°ticamente con una sola ejecuci√≥n. |
| üß† **Consistencia** | Las mismas f√≥rmulas se aplican a todo el conjunto de datos sin riesgo de alterar celdas manualmente. |
| üîÑ **Actualizaci√≥n r√°pida** | Basta con reemplazar los archivos del nuevo mes y volver a correr el script para obtener los reportes actualizados. |
| üìä **Automatizaci√≥n total** | Los reportes, tablas y mapas se pueden generar din√°micamente. |


---

## üìò Lectura de datos {.center}

| Librer√≠a | Prop√≥sito |
|-----------|------------|
| **readxl** | Permite importar archivos de Excel (`.xls`, `.xlsx`) directamente en R. |

üí° *Uso principal:*  
```r
library(readxl)
Datos_IPC_2025 <- read_excel("Datos_IPC_2025.xls")
```


---

## üßπ Manipulaci√≥n y limpieza de datos {.center}


| Librer√≠a | Prop√≥sito |
|-----------|------------|
| **dplyr** | Manipula datos de forma eficiente (`filter`, `mutate`, `summarise`, `left_join`). |

üß© *Ejemplo en el proyecto IPC:*
```r
IPC_interanual_p <- left_join(IPC_interanual,
                              ponderaciones[,c("Codigo","Republica_peso","Region_I_peso","Region_II_peso","Region_III_peso",
                                               "Region_IV_peso","Region_V_peso","Region_VI_peso","Region_VII_peso","Region_VIII_peso")],
                              by = "Codigo")

```

## ‚úèÔ∏è Limpieza de texto y manejo de fechas {.center}


| Librer√≠a | Prop√≥sito |
|-----------|------------|
| **stringr** | Se utiliza para estandarizar el texto de los nombres de meses mediante `str_to_lower()`. |
| **lubridate** | Permite crear y manipular fechas a partir de las columnas de a√±o y mes, utilizando funciones como `make_date()`. |

## ‚úèÔ∏è Limpieza de texto y manejo de fechas {.center}

üß© *Ejemplo con `make_date()`:*
```r
# Mapeo de mes a n√∫mero
mes_map <- c("enero"=1, "febrero"=2, "marzo"=3, "abril"=4, "mayo"=5, "junio"=6,
             "julio"=7, "agosto"=8, "septiembre"=9, "octubre"=10, "noviembre"=11, "diciembre"=12)

IPC_aux <- IPC %>% # 3 nuevas columnas:
    mutate( mes_minuscula  = str_to_lower(Mes), # Crea nueva columna con los meses en min√∫sculas
            mes_numero     = mes_map[mes_minuscula], # Se asocia el nombre "enero" con el 1, tipo BUSCARV en Excel
            fecha          = make_date(A√±o, mes_numero, 1) # fecha que empieza en el d√≠a 1 del mes x y el a√±o z
    )

IPC_aux

    A√±o      Mes      fecha
1  2024    enero  2024-01-01
2  2024  febrero  2024-02-01
3  2024    marzo  2024-03-01
```


---

## ‚öôÔ∏è Texto din√°mico y automatizaci√≥n {.center}

La librer√≠a **`glue`** permite **insertar variables dentro de texto** de manera sencilla.


| Librer√≠a | Prop√≥sito principal |
|-----------|----------------------|
| **glue** | Combina texto y variables en una sola cadena de forma din√°mica y legible. |


¬øPor qu√© usar `glue`?

- Hace m√°s **legible** el c√≥digo que genera texto o nombres autom√°ticos.  
- Evita el uso de `paste()` o `paste0()`, que son menos claros.  
- Es ideal para reportes autom√°ticos, rutas din√°micas y etiquetas personalizadas.

---

### üß© Ejemplo:

```r
library(glue)

region_sel <- "Regi√≥n VII"
mes_sel <- "septiembre"
a√±o_sel <- 2025

titulo_mapa <- glue("Inflaci√≥n mensual - {region_sel}")
subtitulo_mapa <- glue("{str_to_title(mes_sel)} de {a√±o_sel}")

ggplot(mapa_join) +
  geom_sf(aes(fill = inflacion), color = "white") +
  scale_fill_gradient(low = "#fee8c8", high = "#e34a33") +
  labs(
    title = titulo_mapa,
    subtitle = subtitulo_mapa,
    fill = "Inflaci√≥n (%)"
  ) +
  theme_minimal()
```
| M√©todo    | C√≥digo                                                              | Resultado                                            |
| --------- | ------------------------------------------------------------------- | ---------------------------------------------------- |
| `paste()` | `paste("Inflaci√≥n mensual -", region, "(", mes, a√±o, ")")`         | `"Inflaci√≥n mensual - Regi√≥n VII (septiembre 2025)"` |
| `glue()`  | `glue("Inflaci√≥n mensual - {region} ({str_to_title(mes)} {a√±o})")` | `"Inflaci√≥n mensual - Regi√≥n VII (Septiembre 2025)"` |










---

## üó∫Ô∏è Librer√≠as para visualizaci√≥n {.center}

Estas librer√≠as permiten **construir gr√°ficos y mapas tem√°ticos** para analizar la variaci√≥n del IPC por regiones.

| Librer√≠a | Prop√≥sito principal |
|-----------|----------------------|
| **ggplot2** | Crea los gr√°ficos y mapas a partir de los datos (`geom_col`, `geom_line`, `geom_sf`). |
| **sf** | Gestiona la informaci√≥n geogr√°fica: lee, transforma y une mapas (archivos `.shp`, `.geojson`). |

üåç **¬øQu√© hace realmente `sf`?**

`sf` (Simple Features) convierte los mapas ‚Äîque normalmente vienen en archivos espaciales como `.shp`‚Äî  en **data frames geogr√°ficos**, donde cada fila representa una regi√≥n o departamento, y una columna especial contiene la **geometr√≠a** (pol√≠gonos, l√≠neas o puntos).


---

## üó∫Ô∏è Ejemplo: mapa de inflaci√≥n regional {.center}

La librer√≠a **`sf`** se utiliza para **leer, transformar y visualizar** datos espaciales.  

üß© *Ejemplo del c√≥digo real del proyecto:*
```r
# 1Ô∏è‚É£ Leer el mapa base de Guatemala
guatemala_regiones <- read_sf("mapa_base_regiones_administrativas.json") %>% 
    st_set_crs(32616)

belice <- read_sf("mapa_base_belice.json") %>% 
    st_set_crs(32616)

guatemala_lagos <- read_sf("hidrografia_lagos.json") %>% 
    st_set_crs(32616)
    

# 2Ô∏è‚É£ Graficar la inflaci√≥n por regi√≥n
 # Crear el mapa
    ggplot(mapa_completo) +
        geom_sf(aes(fill = inflacion), color = "black", size = 0.3) +
        geom_sf(data = guatemala_lagos,
                fill = "skyblue", color = "gray50", size = 0.15, alpha = 0.5) +
        geom_sf(data = belice,
                fill = NA, color = "gray50", size = 0.15, alpha = 0.5) +
        geom_text(data = centroides, 
                  aes(x = X, y = Y, 
                      label = paste0(
                          case_when(
                              nom_reg == "METROPOLITANA -I-" ~ "I",
                              nom_reg == "NORTE -II-" ~ "II",
                              nom_reg == "NORORIENTE -III-" ~ "III",
                              nom_reg == "SURORIENTE -IV-" ~ "IV",
                              nom_reg == "CENTRAL -V-" ~ "V",
                              nom_reg == "SUROCCIDENTE -VI-" ~ "VI",
                              nom_reg == "NOROCCIDENTE -VII-" ~ "VII",
                              nom_reg == "PET√âN -VIII-" ~ "VIII"
                          ), 
```

---

# ‚úÖMuchas gracias  {.center}


